{{- if and .Values.gatewayAPI.enabled .Values.gatewayAPI.createGateway }}
apiVersion: gateway.networking.k8s.io/v1
kind: Gateway
metadata:
  name: {{ .Values.gatewayAPI.gatewayName | default "kaos-gateway" }}
  namespace: {{ .Release.Namespace }}
  labels:
    {{- include "chart.labels" . | nindent 4 }}
spec:
  gatewayClassName: {{ required "gatewayAPI.gatewayClassName is required when createGateway is true" .Values.gatewayAPI.gatewayClassName }}
  listeners:
  - name: http
    port: {{ .Values.gatewayAPI.listenerPort | default 80 }}
    protocol: {{ .Values.gatewayAPI.listenerProtocol | default "HTTP" }}
    allowedRoutes:
      namespaces:
        from: All
{{- end }}

import{_ as i,o as a,c as e,ag as n}from"./chunks/framework.BypL_Yd_.js";const E=JSON.parse('{"title":"Kubernetes Operator Overview","description":"","frontmatter":{},"headers":[],"relativePath":"operator/overview.md","filePath":"operator/overview.md"}'),t={name:"operator/overview.md"};function l(p,s,h,r,d,k){return a(),e("div",null,[...s[0]||(s[0]=[n(`<h1 id="kubernetes-operator-overview" tabindex="-1">Kubernetes Operator Overview <a class="header-anchor" href="#kubernetes-operator-overview" aria-label="Permalink to &quot;Kubernetes Operator Overview&quot;">​</a></h1><p>KAOS manages the lifecycle of AI agents and their dependencies on Kubernetes.</p><h2 id="architecture" tabindex="-1">Architecture <a class="header-anchor" href="#architecture" aria-label="Permalink to &quot;Architecture&quot;">​</a></h2><div class="language-mermaid vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flowchart TB</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    subgraph api[&quot;Kubernetes API Server&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        crd1[&quot;Agent CRD&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        crd2[&quot;ModelAPI CRD&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        crd3[&quot;MCPServer CRD&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    subgraph controller[&quot;Agentic Operator Controller Manager&lt;br/&gt;(kaos-system namespace)&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ar[&quot;AgentReconciler&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        mr[&quot;ModelAPIReconciler&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        mcpr[&quot;MCPServerReconciler&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    subgraph user[&quot;User Namespace&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ad[&quot;Agent Deployment&lt;br/&gt;+ Service&lt;br/&gt;+ ConfigMap&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        md[&quot;ModelAPI Deploy&lt;br/&gt;+ Service&lt;br/&gt;+ ConfigMap&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        mcpd[&quot;MCPServer Deploy&lt;br/&gt;+ Service&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    crd1 --&gt; ar</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    crd2 --&gt; mr</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    crd3 --&gt; mcpr</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ar --&gt; ad</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mr --&gt; md</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    mcpr --&gt; mcpd</span></span></code></pre></div><h2 id="controllers" tabindex="-1">Controllers <a class="header-anchor" href="#controllers" aria-label="Permalink to &quot;Controllers&quot;">​</a></h2><h3 id="agentreconciler" tabindex="-1">AgentReconciler <a class="header-anchor" href="#agentreconciler" aria-label="Permalink to &quot;AgentReconciler&quot;">​</a></h3><p>Manages Agent custom resources:</p><ol><li><p><strong>Validate Dependencies</strong></p><ul><li>Check ModelAPI exists and is Ready</li><li>Check all MCPServers exist and are Ready</li></ul></li><li><p><strong>Resolve Peer Agents</strong></p><ul><li>Find Agent resources listed in <code>agentNetwork.access</code></li><li>Collect their service endpoints</li></ul></li><li><p><strong>Create/Update Deployment</strong></p><ul><li>Build environment variables</li><li>Configure container with agent image</li><li>Set resource limits</li></ul></li><li><p><strong>Create/Update Service</strong></p><ul><li>Only if <code>agentNetwork.expose: true</code></li><li>Exposes port 80 → container 8000</li></ul></li><li><p><strong>Update Status</strong></p><ul><li>Set phase (Pending/Ready/Failed)</li><li>Record endpoint URL</li><li>Track linked resources</li></ul></li></ol><h3 id="modelapireconciler" tabindex="-1">ModelAPIReconciler <a class="header-anchor" href="#modelapireconciler" aria-label="Permalink to &quot;ModelAPIReconciler&quot;">​</a></h3><p>Manages ModelAPI custom resources:</p><ol><li><p><strong>Determine Mode</strong></p><ul><li>Proxy: LiteLLM container</li><li>Hosted: Ollama container</li></ul></li><li><p><strong>Create ConfigMap</strong> (if needed)</p><ul><li>Wildcard mode: Auto-generated config</li><li>Config mode: User-provided YAML</li></ul></li><li><p><strong>Create/Update Deployment</strong></p><ul><li>Configure container and volumes</li><li>Set environment variables</li></ul></li><li><p><strong>Create/Update Service</strong></p><ul><li>Proxy: Port 8000</li><li>Hosted: Port 11434</li></ul></li><li><p><strong>Update Status</strong></p><ul><li>Record endpoint for agents to use</li></ul></li></ol><h3 id="mcpserverreconciler" tabindex="-1">MCPServerReconciler <a class="header-anchor" href="#mcpserverreconciler" aria-label="Permalink to &quot;MCPServerReconciler&quot;">​</a></h3><p>Manages MCPServer custom resources:</p><ol><li><p><strong>Determine Tool Source</strong></p><ul><li><code>mcp</code>: PyPI package name</li><li><code>toolsString</code>: Dynamic Python tools</li></ul></li><li><p><strong>Create/Update Deployment</strong></p><ul><li>For <code>mcp</code>: Use Python image with pip install</li><li>For <code>toolsString</code>: Use agent image with MCP_TOOLS_STRING</li></ul></li><li><p><strong>Create/Update Service</strong></p><ul><li>Port 80 → container 8000</li></ul></li><li><p><strong>Update Status</strong></p><ul><li>Record available tools</li></ul></li></ol><h2 id="resource-dependencies" tabindex="-1">Resource Dependencies <a class="header-anchor" href="#resource-dependencies" aria-label="Permalink to &quot;Resource Dependencies&quot;">​</a></h2><div class="language-mermaid vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">mermaid</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flowchart LR</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Agent --&gt;|requires| ModelAPI[&quot;ModelAPI (must be Ready)&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Agent -.-&gt;|optional| MCPServers[&quot;MCPServer[] (must be Ready)&quot;]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    Agent -.-&gt;|optional| Peers[&quot;Agent[] (peer agents, must be Ready)&quot;]</span></span></code></pre></div><p>The operator waits for dependencies before marking an Agent as Ready.</p><h2 id="status-phases" tabindex="-1">Status Phases <a class="header-anchor" href="#status-phases" aria-label="Permalink to &quot;Status Phases&quot;">​</a></h2><table tabindex="0"><thead><tr><th>Phase</th><th>Description</th></tr></thead><tbody><tr><td><code>Pending</code></td><td>Resource created, waiting for dependencies</td></tr><tr><td><code>Ready</code></td><td>All dependencies ready, pods running</td></tr><tr><td><code>Failed</code></td><td>Error occurred during reconciliation</td></tr><tr><td><code>Waiting</code></td><td>Waiting for ModelAPI/MCPServer to become ready</td></tr></tbody></table><h2 id="environment-variable-mapping" tabindex="-1">Environment Variable Mapping <a class="header-anchor" href="#environment-variable-mapping" aria-label="Permalink to &quot;Environment Variable Mapping&quot;">​</a></h2><p>The operator translates CRD fields to container environment variables:</p><h3 id="agent-pod-environment" tabindex="-1">Agent Pod Environment <a class="header-anchor" href="#agent-pod-environment" aria-label="Permalink to &quot;Agent Pod Environment&quot;">​</a></h3><table tabindex="0"><thead><tr><th>CRD Field</th><th>Environment Variable</th></tr></thead><tbody><tr><td><code>metadata.name</code></td><td><code>AGENT_NAME</code></td></tr><tr><td><code>config.description</code></td><td><code>AGENT_DESCRIPTION</code></td></tr><tr><td><code>config.instructions</code></td><td><code>AGENT_INSTRUCTIONS</code></td></tr><tr><td>ModelAPI.status.endpoint</td><td><code>MODEL_API_URL</code></td></tr><tr><td><code>config.env[MODEL_NAME]</code></td><td><code>MODEL_NAME</code></td></tr><tr><td><code>config.reasoningLoopMaxSteps</code></td><td><code>AGENTIC_LOOP_MAX_STEPS</code></td></tr><tr><td><code>config.memory.enabled</code></td><td><code>MEMORY_ENABLED</code></td></tr><tr><td><code>config.memory.type</code></td><td><code>MEMORY_TYPE</code></td></tr><tr><td><code>config.memory.contextLimit</code></td><td><code>MEMORY_CONTEXT_LIMIT</code></td></tr><tr><td><code>config.memory.maxSessions</code></td><td><code>MEMORY_MAX_SESSIONS</code></td></tr><tr><td><code>config.memory.maxSessionEvents</code></td><td><code>MEMORY_MAX_SESSION_EVENTS</code></td></tr><tr><td><code>agentNetwork.access</code></td><td><code>PEER_AGENTS</code></td></tr><tr><td>Each peer agent</td><td><code>PEER_AGENT_&lt;NAME&gt;_CARD_URL</code></td></tr></tbody></table><h3 id="modelapi-pod-environment" tabindex="-1">ModelAPI Pod Environment <a class="header-anchor" href="#modelapi-pod-environment" aria-label="Permalink to &quot;ModelAPI Pod Environment&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Mode</th><th>Container</th><th>Key Environment</th></tr></thead><tbody><tr><td>Proxy</td><td>litellm/litellm</td><td><code>proxyConfig.env[]</code></td></tr><tr><td>Hosted</td><td>ollama/ollama</td><td><code>serverConfig.env[]</code>, model pulled on start</td></tr></tbody></table><h3 id="mcpserver-pod-environment" tabindex="-1">MCPServer Pod Environment <a class="header-anchor" href="#mcpserver-pod-environment" aria-label="Permalink to &quot;MCPServer Pod Environment&quot;">​</a></h3><table tabindex="0"><thead><tr><th>Source</th><th>Container</th><th>Key Environment</th></tr></thead><tbody><tr><td><code>mcp</code></td><td>python:3.12-slim</td><td>Package installed via pip</td></tr><tr><td><code>toolsString</code></td><td>kaos-agent</td><td><code>MCP_TOOLS_STRING</code></td></tr></tbody></table><h2 id="rbac-requirements" tabindex="-1">RBAC Requirements <a class="header-anchor" href="#rbac-requirements" aria-label="Permalink to &quot;RBAC Requirements&quot;">​</a></h2><p>The operator requires specific permissions:</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># In operator/config/rbac/role.yaml</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># DO NOT REMOVE - Required for leader election</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">apiGroups</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">coordination.k8s.io</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  resources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">leases</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  verbs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">watch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">patch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">delete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">apiGroups</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  resources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">events</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  verbs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">patch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># For managing resources</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">apiGroups</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">kaos.tools</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  resources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">agents</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">modelapis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">mcpservers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  verbs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">watch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">patch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">delete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">apiGroups</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">apps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  resources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">deployments</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  verbs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">watch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">patch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">delete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">apiGroups</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  resources</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">services</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">configmaps</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  verbs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">list</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">watch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">create</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">patch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">delete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><p><strong>Important:</strong> RBAC rules are generated from <code>// +kubebuilder:rbac:</code> annotations in Go files. Never manually edit <code>role.yaml</code>.</p><h2 id="building-the-operator" tabindex="-1">Building the Operator <a class="header-anchor" href="#building-the-operator" aria-label="Permalink to &quot;Building the Operator&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> operator</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Generate CRDs and RBAC</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> generate</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> manifests</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Build binary</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">go</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bin/manager</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.go</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Build Docker image</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> docker-build</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Deploy to cluster</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> deploy</span></span></code></pre></div><h2 id="running-locally" tabindex="-1">Running Locally <a class="header-anchor" href="#running-locally" aria-label="Permalink to &quot;Running Locally&quot;">​</a></h2><p>For development, run the operator locally:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Scale down deployed operator</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> scale</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> deployment</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kaos-operator-controller-manager</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kaos-system</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --replicas=0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Run locally</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> operator</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span></span></code></pre></div><h2 id="watching-resources" tabindex="-1">Watching Resources <a class="header-anchor" href="#watching-resources" aria-label="Permalink to &quot;Watching Resources&quot;">​</a></h2><p>Monitor operator logs:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> logs</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> kaos-system</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  deployment/kaos-operator-controller-manager</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -f</span></span></code></pre></div><p>Watch custom resources:</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> agents,modelapis,mcpservers</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -A</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -w</span></span></code></pre></div>`,41)])])}const c=i(t,[["render",l]]);export{E as __pageData,c as default};
